const fs=require("fs"),path=require("path"),getAllFiles=function(dirPath,arrayOfFiles){let files=fs.readdirSync(dirPath);return arrayOfFiles=arrayOfFiles||[],files.forEach((function(file){fs.statSync(dirPath+"/"+file).isDirectory()?arrayOfFiles=getAllFiles(dirPath+"/"+file,arrayOfFiles):arrayOfFiles.push([file,path.join(__dirname,dirPath,"/",file)])})),arrayOfFiles},structure=JSON.parse(fs.readFileSync("./structure.json"));for(let niveau in structure)for(let theme in structure[niveau].themes)for(let chapter in structure[niveau].themes[theme].chapitres)structure[niveau].themes[theme].chapitres[chapter]={nom:structure[niveau].themes[theme].chapitres[chapter],exercices:[]};for(let niveau in structure){let listOfFiles;getAllFiles("./N"+niveau).forEach((function(fichierExo){let json=JSON.parse(fs.readFileSync(fichierExo[1])),exo={url:"N"+niveau+"/"+fichierExo[0],title:json.title};for(let i in json.dest){let codechap=json.dest[i],destLevel=codechap.match(/\d+/i),themecode=codechap.match(/\d+[A-Z]/i);void 0!==structure[destLevel]&&structure[destLevel].themes[themecode].chapitres[codechap].exercices.push(exo)}}))}let data=JSON.stringify(structure);fs.writeFileSync("content.json",data);